# 开发日志

## 2023.04.04
### 已完成事务：
1. 重构项目文件夹；
2. 网络游戏通信框架技术选型：Tornado；
3. 完成服务端通信框架的基础搭建以及基本调试；
4. 完成客户端通信框架的基础搭建但未完成调试；
### 目标事务
1. 优先完成客户端通信框架调试并联通测试；
2. 进行策划草案，规划游戏系统构成；

## 2023.04.07
### 已完成事务：
1. 完成客户端通信框架的基础搭建并完成调试；
### 目标事务
1. 两端热更新的配置；
2. 进行策划草案，规划游戏系统构成；

## 2023.04.09
### 已完成事务：
1. 完成客户端窗口与通信框架的结合，并调试；
### 目标事务
1. 客户端插件化框架搭建；
2. 网络连接还需要做：自动重连；
3. 数据库选型、设计，确定通信协议；
4. 两端热更新的配置，供开发使用；
5. 进行策划草案，规划游戏系统构成；

## 2023.04.10
### 已完成事务：
1. 完成客户端插件化框架基础搭建；
2. 完成数据库、通信协议技术选型；
### 目标事务
1. Server Tick 模块开发；
2. 日志模块开发；
3. 网络连接还需要做：自动重连；
4. 两端热更新的配置，供开发使用；
6. 进行策划草案，规划游戏系统构成；

## 2023.04.11
### 已完成事务：
1. 更新更完整的策划案以及开发模块划分；
### 目标事务
1. Server Tick 模块开发；
2. 日志模块开发；
3. 网络连接还需要做：自动重连；
4. 两端热更新的配置，供开发使用；
5. 进行策划草案，规划游戏系统构成；
6. 最后再进行登录模块的开发，因为可能需要使用steam登录的有关api；

## 2023.04.12
### 已完成事务：
1. Server Tick 模块开发；
2. 日志模块基类开发，不过目前只在server这边有，客户端待添加；
### 目标事务
1. 网络连接还需要做：自动重连；
2. 两端热更新的配置，供开发使用；
3. 进行策划草案，规划游戏系统构成；
4. 最后再进行登录模块的开发，因为可能需要使用steam登录的有关api；
### 存在问题
#### server
1. 关于tornado server线程的中断依赖于daemon=True这个参数，即主线程中断时，子线程也一定会中断。这可能会造成一点问题，但目前预判影响不大，后续可跟进。

## 2023.04.13
### 已完成事务：
1. 一些bug的修改；
2. 客户端自动重连，并调试完成；
### 目标事务
1. 两端热更新的配置，供开发使用；
2. 进行策划草案，规划游戏系统构成；
3. 最后再进行登录模块的开发，因为可能需要使用steam登录的有关api；
### 存在问题
#### server
1. 关于tornado server线程的中断依赖于daemon=True这个参数，即主线程中断时，子线程也一定会中断。这可能会造成一点问题，但目前预判影响不大，后续可跟进。
#### client
1. 在开发过程中无法利用ctrl+c进行强行终止进程，原因是qapplication.exec_()堵塞了主线程，所以无法读取键盘信号。现在通过signal.signal(signal.SIGINT, signal.SIG_DFL)进行特殊处理，会导致QTimer终止顺序报错，但预估不影响程序关闭，后续可跟进。

## 2023.04.14
### 已完成事务：
1. 服务端热更新配置，客户端没加，主要是因为热更新并不太适配qt等gui库，这是一个解决起来相当麻烦的问题；
2. 进行策划草案，规划游戏系统构成；
3. 角色工厂创建，但还缺通信协议；
### 目标事务
1. 重要任务：通信协议！！！！！！！！
2. 进行world各个模块开发，由于热更新影响，理应考虑更新前后状态的保存与延续；
3. 最后再进行登录模块的开发，因为可能需要使用steam登录的有关api；
### 存在问题
#### server
1. 关于tornado server线程的中断依赖于daemon=True这个参数，即主线程中断时，子线程也一定会中断。这可能会造成一点问题，但目前预判影响不大，后续可跟进。
#### client
1. 在开发过程中无法利用ctrl+c进行强行终止进程，原因是qapplication.exec_()堵塞了主线程，所以无法读取键盘信号。现在通过signal.signal(signal.SIGINT, signal.SIG_DFL)进行特殊处理，会导致QTimer终止顺序报错，但预估不影响程序关闭，后续可跟进。

## 2023.04.15
### 已完成事务：
1. 完成数据协议的初步设计，当然，它只是一个半成品；
2. 完成组件基类设计，划分组件开发内容；
### 目标事务
1. 陆续开发world各个模块。由于热更新影响，理应考虑更新前后状态的保存与延续；
2. 最后再进行登录模块的开发，因为可能需要使用steam登录的有关api；
### 存在问题
#### server
1. 关于tornado server线程的中断依赖于daemon=True这个参数，即主线程中断时，子线程也一定会中断。这可能会造成一点问题，但目前预判影响不大，后续可跟进。
#### client
1. 在开发过程中无法利用ctrl+c进行强行终止进程，原因是qapplication.exec_()堵塞了主线程，所以无法读取键盘信号。现在通过signal.signal(signal.SIGINT, signal.SIG_DFL)进行特殊处理，会导致QTimer终止顺序报错，但预估不影响程序关闭，后续可跟进。

## 2023.04.16
### 已完成事务：
1. 重构utils文件夹，使其更工程化；
2. 完成bag component构造、database helper构造；
### 目标事务
1. 陆续开发world各个模块。由于热更新影响，理应考虑更新前后状态的保存与延续；
2. 最后再进行登录模块的开发，因为可能需要使用steam登录的有关api；
### 存在问题
#### server
1. 关于tornado server线程的中断依赖于daemon=True这个参数，即主线程中断时，子线程也一定会中断。这可能会造成一点问题，但目前预判影响不大，后续可跟进。
#### client
1. 在开发过程中无法利用ctrl+c进行强行终止进程，原因是qapplication.exec_()堵塞了主线程，所以无法读取键盘信号。现在通过signal.signal(signal.SIGINT, signal.SIG_DFL)进行特殊处理，会导致QTimer终止顺序报错，但预估不影响程序关闭，后续可跟进。
#### database
1. 数据库的更新一般选择在游戏世界tick的时候；但当有需要数据库操作时，应该利用database helper更新database order commit，在每周期后统一更新数据库。这是后续开发方向，由于暂未配置数据库，先用统一注释备注
```python
# use database helper to commit the update
```
2. 考虑初始状态的赋值时间，如创建player时，player attr应该以什么形式、在什么时候赋值；

## 2023.04.18
### 已完成事务：
1. 完成skill component、skill helper的构造，但功能还有待完善，比如技能刷新的tick；
### 目标事务
1. 陆续开发world各个模块。由于热更新影响，理应考虑更新前后状态的保存与延续；
2. 最后再进行登录模块的开发，因为可能需要使用steam登录的有关api，还需要做 LOGIN GATE 和 GAME GATE；
### 存在问题
#### server
1. 关于tornado server线程的中断依赖于daemon=True这个参数，即主线程中断时，子线程也一定会中断。这可能会造成一点问题，但目前预判影响不大，后续可跟进。
#### client
1. 在开发过程中无法利用ctrl+c进行强行终止进程，原因是qapplication.exec_()堵塞了主线程，所以无法读取键盘信号。现在通过signal.signal(signal.SIGINT, signal.SIG_DFL)进行特殊处理，会导致QTimer终止顺序报错，但预估不影响程序关闭，后续可跟进。
#### database
1. 数据库的更新一般选择在游戏世界tick的时候；但当有需要数据库操作时，应该利用database helper更新database order commit，在每周期后统一更新数据库。这是后续开发方向，由于暂未配置数据库，先用统一注释备注
```python
# use database helper to commit the update
```
2. 考虑初始状态的赋值时间，如创建player时，player attr应该以什么形式、在什么时候赋值；

## 2023.04.19
### 已完成事务：
1. 完成skill component、skill helper进一步构造，包括学习、遗忘、升级、降级、重置技能，但tick还没写，后面写attack再写吧，因为我认为可能应该将持续时间放到attack里更好；
2. 确定服务端与客户端之间的通信内容，除了登录，游戏过程中，服务器应该对客户端定期发送Player Attr的数据内容，客户端需要查询但不允许修改该player attr；
### 目标事务
1. 陆续开发world各个模块。由于热更新影响，理应考虑更新前后状态的保存与延续；
2. 最后再进行登录模块的开发，因为可能需要使用steam登录的有关api，还需要做 LOGIN GATE 和 GAME GATE；
### 存在问题
#### server
1. 关于tornado server线程的中断依赖于daemon=True这个参数，即主线程中断时，子线程也一定会中断。这可能会造成一点问题，但目前预判影响不大，后续可跟进。
#### client
1. 在开发过程中无法利用ctrl+c进行强行终止进程，原因是qapplication.exec_()堵塞了主线程，所以无法读取键盘信号。现在通过signal.signal(signal.SIGINT, signal.SIG_DFL)进行特殊处理，会导致QTimer终止顺序报错，但预估不影响程序关闭，后续可跟进。
#### database
1. 数据库的更新一般选择在游戏世界tick的时候；但当有需要数据库操作时，应该利用database helper更新database order commit，在每周期后统一更新数据库。这是后续开发方向，由于暂未配置数据库，先用统一注释备注
```python
# use database helper to commit the update
```
2. 考虑初始状态的赋值时间，如创建player时，player attr应该以什么形式、在什么时候赋值；